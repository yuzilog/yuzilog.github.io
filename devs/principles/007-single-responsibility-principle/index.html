<!doctype html><html lang=zh-cn><head><title>007 Single Responsibility Principle · zlog think
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Deshui Yu"><meta name=description content="链接到标题 软件设计的两个基本准则：低耦合和高内聚
什么是单一职责原则 链接到标题 单一职责原则，指的是一个类或者模块有只有一 个改变的原因。
单一职责可以降低类的复杂性，提高代码可读性、可维护性 我们举例说明单一职责， 看下面一段代码,我们实现一个开关，开灯关灯的实例
const ( // 打开状态 STATE_OK int = 1 // 关闭状态 STATE_ON int = 0 ) // 开关 type Button interface { // 获取状态 GetState() string // 设置状态 SetState(int) } // 灯泡 type Lamp struct { State string } // 获取灯泡状态 func (b *Lamp) GetState() string { return b.State } // 设置灯泡状态 func (b *Lamp) SetState(state int) { switch state { case STATE_OK: b."><meta name=keywords content="blog,developer,personal"><meta name=fediverse:creator content><meta name=twitter:card content="summary"><meta name=twitter:title content="007 Single Responsibility Principle"><meta name=twitter:description content="链接到标题 软件设计的两个基本准则：低耦合和高内聚
什么是单一职责原则 链接到标题 单一职责原则，指的是一个类或者模块有只有一 个改变的原因。
单一职责可以降低类的复杂性，提高代码可读性、可维护性 我们举例说明单一职责， 看下面一段代码,我们实现一个开关，开灯关灯的实例
const ( // 打开状态 STATE_OK int = 1 // 关闭状态 STATE_ON int = 0 ) // 开关 type Button interface { // 获取状态 GetState() string // 设置状态 SetState(int) } // 灯泡 type Lamp struct { State string } // 获取灯泡状态 func (b *Lamp) GetState() string { return b.State } // 设置灯泡状态 func (b *Lamp) SetState(state int) { switch state { case STATE_OK: b."><meta property="og:url" content="/devs/principles/007-single-responsibility-principle/"><meta property="og:site_name" content="zlog think"><meta property="og:title" content="007 Single Responsibility Principle"><meta property="og:description" content="链接到标题 软件设计的两个基本准则：低耦合和高内聚
什么是单一职责原则 链接到标题 单一职责原则，指的是一个类或者模块有只有一 个改变的原因。
单一职责可以降低类的复杂性，提高代码可读性、可维护性 我们举例说明单一职责， 看下面一段代码,我们实现一个开关，开灯关灯的实例
const ( // 打开状态 STATE_OK int = 1 // 关闭状态 STATE_ON int = 0 ) // 开关 type Button interface { // 获取状态 GetState() string // 设置状态 SetState(int) } // 灯泡 type Lamp struct { State string } // 获取灯泡状态 func (b *Lamp) GetState() string { return b.State } // 设置灯泡状态 func (b *Lamp) SetState(state int) { switch state { case STATE_OK: b."><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="devs"><meta property="article:published_time" content="2020-07-31T22:51:03+08:00"><meta property="article:modified_time" content="2020-07-31T22:51:03+08:00"><meta property="article:tag" content="Principles"><meta name=google-adsense-account content="ca-pub-8308665726033207"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/lxgw-wenkai-webfont/1.7.0/lxgwwenkai-regular.min.css integrity="sha512-Fzvxn9FrR1aKr/Z4Pg9KpnVHCsJoq2QwSu1juU2oQ6wDUkUMk3qQUUWKgFjk0m0LzCamIJVOkg5zeyNX5I1wgA==" crossorigin=anonymous referrerpolicy=no-referrer><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8308665726033207" crossorigin=anonymous></script><link rel=canonical href=/devs/principles/007-single-responsibility-principle/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.06cd8dfa5fcefc340f6510c898bc246ec903c5f7891f6dac9ed2205efc4f98cb.css integrity="sha256-Bs2N+l/O/DQPZRDImLwkbskDxfeJH22sntIgXvxPmMs=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5><script src=https://cdnjs.cloudflare.com/ajax/libs/heti/0.9.4/heti-addon.min.js integrity="sha512-GChf2qekcjrSoPicCypQLPqkaZkEnkcsJr85AmkczY0HG5SkfbxOmZY6RoFJLdoeKTGk8EZvkRBaF7BIqV1Ipw==" crossorigin=anonymous referrerpolicy=no-referrer></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/heti/0.9.4/heti.min.css integrity="sha512-/My2cHBMxofuHmAIIK29zje0pIqA2iCC9HDMa76E1jzK5u+wudGzJMMnTsdA5FmVGsoXB1xoJM7fKhniOhz+HA==" crossorigin=anonymous referrerpolicy=no-referrer></head><body class="preload-transitions colorscheme-light"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>zlog think
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/readings/>读书</a></li><li class=navigation-item><a class=navigation-link href=/posts/>技术</a></li><li class=navigation-item><a class=navigation-link href=/about/>关于我</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=/devs/principles/007-single-responsibility-principle/>007 Single Responsibility Principle</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2020-07-31T22:51:03+08:00>July 31, 2020
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
阅读时间：1 分钟</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/principles/>Principles</a></span></div></div></header><div class=post-content><div class="article-content heti"><h2 id=heading><a class=heading-link href=#heading><i class="fa-solid fa-link" aria-hidden=true title=链接到标题></i>
<span class=sr-only>链接到标题</span></a></h2><blockquote><p>软件设计的两个基本准则：低耦合和高内聚</p></blockquote><h3 id=什么是单一职责原则>什么是单一职责原则
<a class=heading-link href=#%e4%bb%80%e4%b9%88%e6%98%af%e5%8d%95%e4%b8%80%e8%81%8c%e8%b4%a3%e5%8e%9f%e5%88%99><i class="fa-solid fa-link" aria-hidden=true title=链接到标题></i>
<span class=sr-only>链接到标题</span></a></h3><p><strong>单一职责原则，指的是一个类或者模块有只有一 个改变的原因。</strong></p><ul><li>单一职责可以降低类的复杂性，提高代码可读性、可维护性</li></ul><p>我们举例说明单一职责， 看下面一段代码,我们实现一个开关，开灯关灯的实例</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>const</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=c1>// 打开状态
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>STATE_OK</span> <span class=kt>int</span> <span class=p>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>	<span class=c1>// 关闭状态
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>STATE_ON</span> <span class=kt>int</span> <span class=p>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 开关
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>Button</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=c1>// 获取状态
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nf>GetState</span><span class=p>()</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>	<span class=c1>// 设置状态
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nf>SetState</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 灯泡
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>Lamp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>State</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 获取灯泡状态
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=o>*</span><span class=nx>Lamp</span><span class=p>)</span> <span class=nf>GetState</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>b</span><span class=p>.</span><span class=nx>State</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 设置灯泡状态
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=o>*</span><span class=nx>Lamp</span><span class=p>)</span> <span class=nf>SetState</span><span class=p>(</span><span class=nx>state</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>switch</span> <span class=nx>state</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>case</span> <span class=nx>STATE_OK</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=nx>b</span><span class=p>.</span><span class=nx>State</span> <span class=p>=</span> <span class=s>&#34;开灯&#34;</span>
</span></span><span class=line><span class=cl>	<span class=k>case</span> <span class=nx>STATE_ON</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=nx>b</span><span class=p>.</span><span class=nx>State</span> <span class=p>=</span> <span class=s>&#34;关灯&#34;</span>
</span></span><span class=line><span class=cl>	<span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=nx>b</span><span class=p>.</span><span class=nx>State</span> <span class=p>=</span> <span class=s>&#34;未知状态&#34;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>调用代码</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>btn</span> <span class=nx>principles</span><span class=p>.</span><span class=nx>Button</span>
</span></span><span class=line><span class=cl>	<span class=nx>lamp</span> <span class=o>:=</span> <span class=nx>principles</span><span class=p>.</span><span class=nx>Lamp</span><span class=p>{</span><span class=nx>State</span><span class=p>:</span> <span class=s>&#34;关灯&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=c1>// 实现组合
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>btn</span> <span class=p>=</span> <span class=o>&amp;</span><span class=nx>lamp</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// 开灯
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>btn</span><span class=p>.</span><span class=nf>SetState</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>t</span><span class=p>.</span><span class=nf>Log</span><span class=p>(</span><span class=s>&#34;灯泡状态：&#34;</span><span class=p>,</span> <span class=nx>btn</span><span class=p>.</span><span class=nf>GetState</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// 关灯
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>btn</span><span class=p>.</span><span class=nf>SetState</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>t</span><span class=p>.</span><span class=nf>Log</span><span class=p>(</span><span class=s>&#34;灯泡状态：&#34;</span><span class=p>,</span> <span class=nx>btn</span><span class=p>.</span><span class=nf>GetState</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=o>----------</span>
</span></span><span class=line><span class=cl><span class=o>==</span><span class=p>=</span> <span class=nx>RUN</span>   <span class=nx>TestButton_SetName</span>
</span></span><span class=line><span class=cl><span class=o>---</span> <span class=nx>PASS</span><span class=p>:</span> <span class=nf>TestButton_SetName</span> <span class=p>(</span><span class=mf>0.00</span><span class=nx>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>principles_test</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>122</span><span class=p>:</span> <span class=nx>灯泡状态</span><span class=err>：</span> <span class=nx>开灯</span>
</span></span><span class=line><span class=cl>    <span class=nx>principles_test</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>126</span><span class=p>:</span> <span class=nx>灯泡状态</span><span class=err>：</span> <span class=nx>关灯</span>
</span></span></code></pre></div><p>在SetState这种实现在我们代码中就经常看见，由switch..case 的当时进行状态或逻辑处理。这里可以看出，我们这个函数是担任多个职责的，如果再新增一个状态，就要修个这个代码。如果是在复杂的代码中会变的难以维护。</p><p>下面我们简单修改下，就行代码职责的修改</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 开关
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>Button</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=c1>// 获取状态
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nf>GetState</span><span class=p>()</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>	<span class=c1>// 开灯
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nf>OpenState</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=c1>// 关
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nf>CloseState</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=o>*</span><span class=nx>Lamp</span><span class=p>)</span> <span class=nf>OpenState</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>b</span><span class=p>.</span><span class=nx>State</span> <span class=p>=</span> <span class=s>&#34;开灯&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=o>*</span><span class=nx>Lamp</span><span class=p>)</span> <span class=nf>CloseState</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>b</span><span class=p>.</span><span class=nx>State</span> <span class=p>=</span> <span class=s>&#34;开灯&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>调用代码</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 开灯
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>btn</span><span class=p>.</span><span class=nf>OpenState</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>t</span><span class=p>.</span><span class=nf>Log</span><span class=p>(</span><span class=s>&#34;灯泡状态：&#34;</span><span class=p>,</span> <span class=nx>btn</span><span class=p>.</span><span class=nf>GetState</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// 关灯
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>btn</span><span class=p>.</span><span class=nf>CloseState</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>t</span><span class=p>.</span><span class=nf>Log</span><span class=p>(</span><span class=s>&#34;灯泡状态：&#34;</span><span class=p>,</span> <span class=nx>btn</span><span class=p>.</span><span class=nf>GetState</span><span class=p>())</span>
</span></span></code></pre></div><p>看到这样代码，是不是感觉清晰了，如果在开灯的地方需要加一个延时打开灯泡的代码，是否不用关心关闭的代码。</p><p>这就是软件设计的单一职责原则。如果一个类或者函数承担的职责太多，就等于把这些职责都耦合在一起。这种耦合会导致类很脆弱：当变化发生的时候，会引起类不必要的修改，进而导致 bug 出现。</p><p>职责太多，还会导致类的代码太多。一个类太大，它就很难保证满足开闭原则，如果不得不打开类文件进行修改，大堆大堆的代码呈现在屏幕上，一不小心就会引出不必要的错误。</p><p>写出好的代码的最佳实践，首先是<strong>控制一个文件的行数</strong></p></div></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2015 -
2024
Deshui Yu
·</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-RYHFS1K5ZH"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-RYHFS1K5ZH")</script></body></html>